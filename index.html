<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <meta name="referrer" content="no-referrer"> -->

    <title>Resume</title>


    <!-- style for template -->
    <link rel="stylesheet" href="style.css">
    <!-- style for input -->
    <link rel="stylesheet" href="style1.css">

    <!-- Include jsPDF from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Include html2canvas from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.2/html2canvas.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

</head>

<body>
    <div class="container">

        <!-- Tabs for Different Sections -->
        <div class="tabContainer">
            <button class='tabButton active' onclick="tabs('basicTab')">Basic Info</button>
            <button class='tabButton' onclick="tabs('summaryTab')">Summary</button>
            <button class='tabButton' onclick="tabs('educationTab')">Education</button>
            <button class='tabButton' onclick="tabs('experienceTab')">Experience</button>
            <button class='tabButton' onclick="tabs('skillsTab')">Skills</button>
            <button class='tabButton' onclick="tabs('projectsTab')">Projects</button>
        </div>

        <div class="formCont">

            <div class="basicData tabContent active" id="basicTab">
                <h2>Basic Info</h2>
                <div class="data">
                    <input type="text" id="inputName" placeholder="Enter Name" />
                    <input type="text" id="inputPhone" placeholder="Phone Number" />
                    <input type="email" id="inputEmail" placeholder="Email" />
                    <input type="text" id="inputGithub" placeholder="github.com/id" />
                    <button id="updateTemplate">Update Template</button>
                </div>
            </div>

            <div class="summaryData tabContent" id="summaryTab">
                <h2>Summary</h2>
                <div class="data">
                    <textarea id="inputSummary" placeholder="Write a short summary or objective"></textarea>
                    <button id="summary">Add Summary</button>
                </div>
            </div>

            <!-- Education Info -->
            <div class="basicEducation tabContent" id="educationTab">
                <h2>Education Info</h2>
                <div class="educationDataInput">
                    <input type="text" id="inputCourseName" placeholder="Course Name" />
                    <input type="text" id="inputCoursePercentage" placeholder="Percentage" />
                    <input type="text" id="inputCourseYear" placeholder="may 2023-june 2024" />
                    <input type="text" id="inputCollegeName" placeholder="College Name" />
                    <button id="addEducation">Add Education</button>
                </div>
            </div>

            <!-- Experience Info -->
            <div class="basicExperience tabContent" id="experienceTab">
                <h2>Experience Info</h2>
                <div class="experienceDataInput">
                    <input type="text" id="inputJobTitle" placeholder="Job Title" />
                    <input type="text" id="inputCompanyName" placeholder="Company Name" />
                    <input type="text" id="inputExperienceYear" placeholder="Year" />
                    <button id="addExperience">Add Experience</button>
                </div>
            </div>

            <!-- Skills Info -->
            <div class="basicSkills tabContent" id="skillsTab">
                <h2>Skills Info</h2>
                <div class="skillsDataInput">
                    <input type="text" id="inputSkill" placeholder="Skill Name" />
                    <button id="addSkill">Add Skill</button>
                </div>
            </div>

            <!-- projects -->
            <div class="basicProjects tabContent" id="projectsTab">
                <h2>Projects</h2>
                <div class="projectDataInput">
                    <input type="text" id="inputProjectName" placeholder="Project Name" />
                    <input type="url" id="inputProjectLink" placeholder="Project Link (optional)" />
                    <textarea id="inputProjectDescription" placeholder="Description"></textarea>
                    <button id="addProject">Add Project</button>
                </div>
            </div>

        </div>

        <div class="buttons">
            <button id="previewTemplate" onclick="openModal()">Preview</button>
            <button id="printTemplate">Save as PDF</button>
            <!-- <button id="saveAsWord">Save as Word</button> -->
        </div>
        <!-- ************Template 1************ -->
        <div id="modal" style="display:none">
            <i class="closeModal fa-solid fa-xmark" onclick="closeModal()"></i>
            <div class="modalContent">
                <div class="template1">

                    <!-- template header -->
                    <div class="header">
                        <h1 id="name">[Your Name]</h1>
                        <div class="headerData">
                            <div class="phoneNum" id="phone">[Phone Number]</div> |
                            <div class="email" id="email">[Email]</div> |
                            <div class="github" id="github">[GitHub Link]</div>
                        </div>
                    </div>

                    <div class="summary">
                        <h3 class="subheader">Summary</h3>
                        <div id="summarytxt"></div>
                    </div>

                    <!-- education -->
                    <div class="education">
                        <h3 class="subheader">Education</h3>
                        <div id="educationData">
                            <div class="courseData">
                                <div id="courseName">
                                    <div id="percentage"></div>
                                </div>
                                <!-- <div id="courseYear">jul 2023-jul 2024</div> -->
                            </div>

                            <!-- course colg -->
                            <div class="courseColg">
                                <!-- <p id="address"></p> -->
                            </div>
                        </div>
                    </div>

                    <!-- experience -->
                    <div class="experience">
                        <h3 class="subheader">Experience</h3>
                        <div id="experienceData">
                            <div class="data">
                                <!-- <p id="courseName">Msc. IT -->
                                <!-- <div id="percentage">72%</div> -->
                                </p>
                                <!-- <p id="courseYear">jul 2023-jul 2024</p> -->
                            </div>
                            <div class="courseColg">
                                <!-- <p id="address">Ripudamn Colg Nabha</p> -->
                            </div>
                        </div>
                    </div>

                    <!-- ******Skills**** -->
                    <div class="skills">
                        <h3 class="subheader">Skills</h3>
                        <div class="skillData">
                            <ul>
                                <!-- <li>Frontend : html, css</li>
                        <li>Backend : python</li> -->
                            </ul>
                        </div>
                    </div>

                    <!-- ****Projects*** -->
                    <!-- Projects -->
                    <div class="projects">
                        <h3 class="subheader">Projects</h3>
                        <div id="projectData">
                            <!-- Dynamically added projects will appear here -->
                        </div>
                    </div>

                </div>
            </div>
            <button id="printTemplate">Save as PDF</button>
        </div>

        <!-- template 2 -->

    </div>

    <script src="./html2canvas.js"></script>
    <script src="script.js"></script>

    <!-- Include jsPDF from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>


    <script>
document.getElementById("printTemplate").addEventListener("click", function () {
    const { jsPDF } = window.jspdf;

     // Ensure no elements are hidden if they don't exist
     const noPrintElements = document.querySelectorAll(".no-print");
    noPrintElements.forEach(element => element.style.display = "none");

    // Select the elements to process
    const template = document.querySelector(".template1");
    const modal = document.getElementById("modal");
    const modalContent = document.querySelector(".modalContent");
    template.style.display = "block";


    // Function to temporarily detach the template
    function detachTemplate(template) {
        const placeholder = document.createComment("Template placeholder");
        template.parentNode.replaceChild(placeholder, template);
        document.body.appendChild(template); // Move template to body temporarily
        return placeholder; // Return the placeholder to restore later
    }

    // Function to restore the template
    function restoreTemplate(template, placeholder) {
        placeholder.parentNode.replaceChild(template, placeholder);
    }

    // Detach the template from its nested parent structure
    const placeholder = detachTemplate(template);

    // Use html2canvas to capture the template
    html2canvas(template, {
        backgroundColor: "#ffffff", // Ensure white background
        scale: 2 // Higher scale for better quality
    }).then(canvas => {
        const pdf = new jsPDF("p", "mm", "a4"); // A4 page in mm
        const imgData = canvas.toDataURL("image/png");

        // Calculate dimensions to fit content within A4
        const imgWidth = 210; // Full A4 width in mm
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        // Add the image to the PDF
        pdf.addImage(imgData, "PNG", 0, 0, imgWidth, imgHeight);

        // Save the PDF
        pdf.save("resume.pdf");
    }).catch(error => {
        console.error("Error generating PDF:", error);
    }).finally(() => {
        // Restore the template back to its original position
        restoreTemplate(template, placeholder);
    });
});

    </script>

</body>

</html>